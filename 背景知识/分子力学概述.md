# 分子力学概述

分子力学（molecular mechanics）, 又称力场方法, 建立在经典力学理论基础上，借助经验和半经验参数计算分子结构和能量的方法，又称力场方法（force field method）。

## 原理

基于玻恩–奥本海默近似(Born Oppenheimeri approximation)，系统能量表示为原子核位置的函数，忽略电子运动。分子被描述为一系列带电的点（原子），通过化学键相互连接。为了描述键长、键角、扭转角的时间演化，以及原子之间的非键范德华力和静电相互作用，人们使用力场来描述这些参数。力场通过参数化这些能量项的公式和常数，将原子之间的相互作用转化为力和能量的数学表示。这些参数可以通过实验数据、量子化学计算或经验拟合等方法获得。通过力场，可以计算分子系统中原子、分子之间的相互作用力，从而模拟分子的结构、动力学和热力学行为。力场在分子模拟和计算化学研究中起着重要的作用，能够预测分子的构象、热力学性质、反应机理等重要信息。

- 分子总能量=动能+势能
- 当温度为 0 K，势能=总能量
- 势能=成键势能+非键势能，下面又分出若干小项，各个势能项都有函数表达式描述

## 相互作用类型

- interactions：**计算原子间相互作用是分子动力学模拟的核心问题**
- 根据现代物理力学理论, 宇宙中存在的四种基本相互作用.
- 而分子间相互作用力(分子间引力)属于电磁相互作用引起, 是介导分子间相互作用的力, 包括作用于原子和其他类型的相邻粒子（例如原子或离子）之间的吸引力或排斥力.
- 根据强弱又分为: 成键相互作用和非键相互作用
- 分子间相互作用力(非键相互作用) 相对于分子内相互作用力（键相互作用）来说是微弱的

### bonded

> 成键相互作用

- 根据参与形成的粒子个数, 分为
  - bond 键
  - angle 角
  - dihedral 二面体

### nobonded

> 非键相互作用

- 短程相互作用
  - 主要指Van der Waals相互作用（包括色散和排斥）
  - 表现形式如短程作用势 Lennard-Jones势
  - 周期性边界条件、截断半径和近邻搜索都是针对短程相互作用的
- 长程相互作用
  - 库仑、偶极、静电
  - 处理长程相互作用的方法：Ewald求和、反应场方法、PPPM方法

#### 范德华力

- 范德华力（Van der Waals force；又名:范德瓦耳斯力）：起初为了修正范德华方程而提出。普遍存在于固、液、气态任何微粒之间，与距离六次方成反比。
- 在化学中指分子或非极性原子（稀有气体）之间非定向的、无饱和性的、较弱的相互作用力，包括排斥力和吸引力
- 范德华力是分别来自两个分子中的一种中性原子之间通过瞬间静电相互作用产生的一种弱的分子之间的力，这是由于附近粒子波动极化的相关性引起的（量子动力学的结构），具体而言，电子密度可能会暂时更大地转移到原子核的一侧。这会产生一个瞬态电荷，附近的原子可以被吸引或排斥。
- 化学键或共价键弱得多，通常其能量小于5kJ/mol（0.4~4kJ/mol）
- 当两个原子之间的距离为它们的范德华半径之和时，范德华引力最强。
- 强的范德华排斥作用可以防止原子相互靠近。范德华力的大小和分子的大小成正比。
- 范德华力的来源
  - 固有偶极：极性分子中由于组成元素不同，其吸引电子的能力各有差异（元素周期律），这就使得分子中有电子偏移的现象，这样就产生了极性，并且偶极持续存在，称为固有偶极。
  - 诱导偶极：是指非极性分子在电场中或者有其他极性分子在较近距离的情况下，由于电子带负电，核带正电，它们会发生偏移，这种现象称为诱导偶极。
  - 瞬时偶极：一切分子中，不管是极性分子还是非极性分子，原子核时刻在震动，电子时刻在运动、跃迁，在它们运动的时候，偶尔离开平衡位置而产生极性，只不过这个过程持续时间很短，故称瞬时偶极。
- 范德华力的分类
  - 取向力（1912-Keesom force）：固有偶极之间的电性引力；(热平均固有偶极——固有偶极相互作用).
  - 诱导力（1921 Debye force）：诱导偶极与固有偶极之间的电性引力，如离子诱导偶极力和偶极诱导偶极力。(热平均固有偶极——诱导偶极相互作用)
  - 色散力（London force）：瞬时偶极之间的电性引力；(诱导偶极——诱导偶极相互作用)

#### LJ势

- 有很多方程能描述范德华相互作用，其中最常见的为LJ势函数。

> Lennard-Jones 势模拟了两个最重要和最基本的分子相互作用：其中排斥项 $(\frac{1}{r_{ij}})^{12}$ 描述了在相互作用粒子的短距离上由于重叠电子轨道而产生的泡利斥力，吸引项 $(\frac{1}{r_{ij}})^6$ 描述了长距离相互作用（主要为色散力）的吸引力，在两个粒子之间的无限距离处消失。短距离的陡峭排斥相互作用导致固相和液相的低压缩性；有吸引力的分散相互作用对凝聚相起到稳定作用，尤其是汽液平衡。吸引项的函数形式，即指数“6”，具有物理上的合理性，对于具有指数“12”的排斥项并不严格。简单原子和分子之间有吸引力的色散相互作用是部分电荷波动的结果。量子化学计算表明，这种色散贡献必须以 $(\frac{1}{r_{ij}})^6$ 的速度衰减。$(\frac{1}{r_{ij}})^{12}$ 项被使用，主要是因为它在计算上可以非常有效的实现为 $(\frac{1}{r_{ij}})^6$ 的平方，这对于'12'以外的值不成立。此外, $(\frac{1}{r_{ij}})^{12}$ 合理地接近了泡利斥力，可以使用任意指数而不是12和6来推广Lennard-Jones势能.

- Lennard-Jones potential(LJ势或者12-6势), 描述了简单原子和分子之间相互作用的基本特征：两个相互作用的粒子在非常近的距离相互排斥，在中等距离相互吸引，在无限距离上不相互作用
- LJ势是两体势, 不包含三体或多体相互作用
- LJ势是研究最广泛和最彻底的势，被认为是简单而现实的分子键相互作用的半经验模型。
- 常用表达式: $E_{LJ}=4\epsilon[(\frac{\sigma}{r_{ij}})^{12}-(\frac{\sigma}{r_{ij}})^6]$
  - $E_{LJ}$ 为两体之间的势能大小。
  - $\epsilon$ 为控制相互作用的强度（以 eV 为单位）,从本质上讲，它衡量两体相互吸引的强度,通常称为势阱深度（也叫“色散能”）;
  - $\sigma$ 为相互作用的势能正好为零时的两原子间的距离，给出了两个非键合粒子的接近程度的度量，因此被称为范德瓦尔斯半径。它等于非成键粒子之间核间距离的二分之一。
  - $r_{ij}$ 为i,j两体之间的距离。
- 在实际应用中，$\epsilon$和$\sigma$参数往往通过拟合已知实验数据或精确量子计算结果而确定。
- 除了以上的等式之外，还有几种不同的形式来表示LJ势能函数: AB型, n-m型

> LJ势不仅在在计算化学和软物质物理学中至关重要，而且对于真实物质的建模也是如此。使用LJ势计算出的宏观特性，一方面与氩气等简单物质的实验数据有很好的一致性，另一方面势函数与量子化学的结果有相当的一致性。同样的，LJ势对液相中的分子相互作用有很好的描述，而对固相中的分子相互作用则只有大致的描述。这主要是由于多体相互作用在固相中起着重要作用，而LJ势中不包括这些作用。因此，LJ势被广泛用于软物质物理学和相关领域，而在固体物理学中却不常使用。由于其简单性，经常被用来描述气体和简单流体的特性，并在分子模型中建立色散和排斥相互作用的模型。它对惰性气体原子和甲烷特别准确。此外，对于中性原子和分子的长距离和短距离的分子相互作用计算，它也能产生一个很好的近似值。因此，LJ势经常被用作复杂分子（如烷烃或水）的分子模型的构建模块（力场中的非键相互作用势能项）。大量的力场都是基于LJ势，例如TraPPE力场,OPLS力场,和MolMod力场,（对分子力场的概述不在本文讨论范围之内）对于最先进的固态材料建模，使用了更复杂的多体势（如EAM势）。此外LJ势还可用于模拟固-液界面上的吸附作用，即物理吸附或化学吸附。

- 模拟LJ势, todo


## 力场分类

不同的力场可能适用于不同类型的分子和研究问题，选择合适的力场对于获得准确和可靠的模拟结果至关重要。

1. 全原子力场（all-atomforcefields）：每个原子都作为一个粒子明确考虑。体系的力点与分
   子中的全部原子一一对应。
2. 联合原子力场（united-atomforcefields）：将与碳原子直接键连的氢原子的相对原子质量
   叠加到碳原子上，形成联合原子整体。力点的数量少于分子中原子的数量，是分子的不完全描述。
3. 粗粒度力场（coarse-grained force fields）：粗粒度力场中可以把苯环及其键连的氢原子作
   为一个整体力点，甚至把若干个水分子作为一个整体力点。
4. 反应性分子力场（reactiveforcefields）：为了在经典MD模拟中研究化学反应，引入反应性
   分子力场以允许化学键的断裂和生成

注意蛋白质力场，小分子力场，和水分子模型的搭配

## 常见分子力场

力场文件通常以特定的格式（如AMBER格式、CHARMM格式或GROMOS格式）存储，并包含描述分子的拓扑信息和相互作用参数。

1. **AMBER力场**：AMBER（Assisted Model Building with Energy Refinement）力场是广泛应用的力场之一。它提供了多个版本，如AMBER94、AMBER99和AMBER ff03等。AMBER力场主要用于蛋白质和核酸的模拟研究。
2. **CHARMM力场**：CHARMM（Chemistry at Harvard Molecular Mechanics）力场是另一个常用的力场。它包括多个版本，如CHARMM22和CHARMM36等。CHARMM力场广泛应用于蛋白质、核酸、脂质和碳水化合物等生物分子的模拟。
3. **GROMOS力场**：GROMOS（Groningen Molecular Simulation）力场是由Groningen大学开发的力场。它适用于溶液中的生物分子模拟，并提供了多个版本，如GROMOS53A6和GROMOS96等。
4. **OPLS力场**：OPLS（Optimized Potentials for Liquid Simulations）力场是用于液体模拟的力场。它提供了多个版本，包括OPLS-AA（全原子力场）和OPLS-UA（United Atom力场）。OPLS力场广泛应用于脂质、多肽和蛋白质等系统的模拟。
5. **AMBER-ff系列力场**：AMBER-ff（AMBER Force Field）系列力场是AMBER力场的衍生版本，针对特定类别的分子进行了参数化。例如，AMBER-ff99SB力场专门用于蛋白质模拟，而AMBER-ff99SB-ILDN力场用于蛋白质折叠和去折叠的模拟。
6. **CVFF 力场**(Consistent Valence Force Field)，属传统力场。适应于有机小分子和蛋白质体系。扩展后可用于某些无机体系的模拟，如硅酸盐、铝硅酸盐、磷硅化合物等，主要用于预测分子的结构和结合自 由能。
7. CFF：consistent force field，一致性力场。PCFF，衍生，适用于聚合物和有机物
8. **MMX 力场**：包括 MM2 和 MM3，是目前应用最为广泛的力场，主要针对有机小分子。也可用于生物大分子体系，计算速度较慢。第二代力场比传统力场要更加复杂，涉及的力场参数更多，计算量也更大，当然也相应地更加准确。
9. 此外，还有其他一些力场，如MMFF（Merck Molecular Force Field）、UFF（Universal Force Field）等，它们适用于小分子和药物化学等领域的模拟研究。

- 常用的蛋白质力场
  - Amber系列
  - Charmm系列
  - OPLS系列
  - Gromos系列
- 常用的脂质力场
  - Amber系列
  - Charmm系列
  - Slipid
  - Gromos系列
- 常用的小分子力场
  - GAFF
  - CGenFF
  - OPLS
- 常用的核酸力场
  - Amber系列
  - Charmm系列
- 常用的糖类力场
  - GLYCAM
  - Charmm系列
  - OPLS系列
- 其它体系的力场
  - UFF, Dreiding
  - ReaxFF
  - MARTINI
- 通用力场：以原子为基础的力场，ESFF、UFF、DREDING

## 拓展阅读

[力场选择-分子动力学 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/458825807)
[科学网—力场与拓扑之二：如何选择力场](https://blog.sciencenet.cn/blog-548663-942121.html)
