# 统计力学概述

统计力学（又叫统计物理学）是研究大量粒子（原子、分子）集合的宏观运动规律的科学。统计力学（Statistical mechanics）是一个以玻尔兹曼等人提出以最大乱度理论为基础，借由配分函数将有大量组成成分（通常为分子）系统中微观物理状态（例如：动能、位能）与宏观物理量统计规律 （例如：压力、体积、温度、热力学函数、状态方程等）连结起来的科学。

- 分子动力学模拟 (MD , Molecular Dynamics，描述的是全部原子粒子的经典运动轨迹，而统计物理学（统计力学）是分子动力学和Monte Carlo方法的理论基础。
- 分子模拟的一大用途就是对体系的平衡态进行模拟采样得到体系的某些热力学数据。分子动力学模拟要获得的这些数据正需要统计力学将运动状态与物理量联系起来。
- 热力学和统计物理都是研究系统相关物理量，但角度不同
- 系统作为一个大量粒子的集合，每个粒子的运动状态是随时间不断变化的，因此系统的状态也是随时间不断变化的。
- **微观态**：在某一时刻，粒子的运动状态是确定的
- **统计物理的基本原理**：由于微观态变化很快，而对于宏观量的一次测量所历经的时间尺度远大于微观态变化的时间尺度。因此对于**宏观量的测量结果为在测量过程中所测到的所有微观态的平均值**。
- 设想将系统复制无数份，在相同的宏观条件下，每份复制系统均处于某一个可能的微观态。这些系统的集合就叫做**统计系综**。把系综中处于某个微观态的数目占系综中系统总数的比值，叫做**统计系综分布**，即可能的微观态的概率分布 𝜌 。可由 𝜌求出系统的宏观量：  
  - $\bar{u}(t)=\sum_i\rho_i<\Psi^i(t)|\hat{u}|\Psi^i(t)>$  
  - $\bar{u}(t)=\iint_{\Gamma_V}\rho(q,p,t)u(q,p,t)\mathrm{d}q\mathrm{d}p$

## 分类

量子统计与经典统计的研究对象和研究方法相同，在量子统计中系综概念仍然适用。区别在于量子统计认为微观粒子的运动遵循量子力学规律而不是经典力学规律，微观运动状态具有不连续性，需用量子态而不是相宇（相空间）来描述 。

> 统计力学：其一为**量子统计力学**, 其二为**经典统计力学**。

1. 量子统计力学

- 基于量子力学原理, 适用 于微观的, 小尺度, 短时 间的模拟，可以描述电子 的结构分布，原子间的成 键断键等化学性质。

2.经典纭计力学

- 基于牛顿经典力学, 模拟 的尺度和时间相比于量子 统计力学较大, 它以每个 原子作为一个质点, 主要 研究课题的物理性质。

## 系综

- **Ensemble**，又称统计系综：是在一定的宏观条件下，大量性质和结构完全相同的、处于各种运动状态的、各自独立的系统的集合。
  - **宏观条件**包括: 粒子数, 体积, 能量, 温度, 压力
- 系综是用统计方法描述热力学系统的统计规律性时引入的一个基本概念
  - 宏观物质性质就是各种微观体系平均的结果，而系综就是各种微观体系的概率体系。换句话说系综描述了这些体系的的整体行为.

### 系综分类

- 微正则系综 (𝑁,𝑉,𝐸)
  - 处于平衡态的，具有相同的总粒子数 𝑁 ，体积 𝑉 和总能量 𝐸 的系综叫做微正则系综（孤立系）。
  - 系统处于静止状态时，系综密度函数仅与Hamilton量有关， 𝜌=𝜌(𝐻) 。
  - 根据**Boltzmann等概率原理：处于平衡态的孤立系统处于各个可能的微观态的概率均相等**。
  - 通过调整原子的速度来调整能量, 需要迭代和弛豫来达到热平衡
- **正则系综** (𝑁,𝑉,𝑇)
  - 处于平衡态的，具有相同的总粒子数 𝑁 ，体积 𝑉 和温度 𝑇 的系综叫做正则系综（闭系）。
  - 等效为一个孤立系=闭系+同温大热源
  - 系统与外界的大热源达到热平衡的恒温系统
  - 通过调整原子的速度来保持系统的动能恒定
- **等温等压系综**(isothermal-isobaric ensemble, NPT)
  - 确定的粒子数, 压强和温度
  - 通过调整系统的体积来保持压力的恒定, 模拟真实世界中的压力条件
- 巨正则系综 (𝑉,𝑇,𝜇)
  - 处于平衡态的，具有相同的体积 𝑉 ，温度 𝑇 和化学势 𝜇 的系综叫做巨正则系综（开系）。
  - 等效为一个孤立系=开系+同温粒子源
  - 系统与外界的大热源和大粒子源达到热平衡, 具有恒定的温度和化学式
  - 粒子数是可以变化的
- 等压等焓系综(contant-pressure,constant-enthalpy, NPH)
  - 具有确定的粒子数, 压强和焓
  - 在分子动力学模拟中不常见(lammps支持)
- 总结: 在平衡态统计理论中，对于能量和粒子数固定的孤立系统，采用微正则系综（NVE）；对于可以和大热源交换能量但粒子数固定的系统，采用正则系综（NVT）；对于可以和大热源交换能量和粒子的系统，采用巨正则系综。

### 系综的选择

在分子动力学模拟中，我们可以使用不同的系综来描述系统的状态，常用的有: **NVT系综**、**NPT系综**、VTμ系综等等

- NVT模拟的是与外界有温度交换但无能量和粒子交换的系统
  - 在NVT系综中，我们可以通过控制温度来研究系统的性质。
  - 例如，我们可以使用NVT系综来研究液体的结构和动力学性质。通过分子动力学模拟，我们可以模拟出液体分子的运动轨迹和相互作用，从而研究液体的性质。
- NPT模拟的是一个与外界与压力交换但无能量交换的系统。
  - 在NPT系综中，我们可以通过控制压力来研究系统的性质。
  - 例如，我们可以使用NPT系综来研究气体的相变和液体的密度。通过分子动力学模拟，我们可以模拟出气体和液体分子的运动轨迹和相互作用，从而研究它们的性质。
  - NPT能够模拟更接近生物实验条件的压力变化, 适用于形状压力变化较大的体系, 如蛋白质的折叠与展开.
  - NPT的计算性能不如NVT, NVT更适合长时间, 形状变化不大的体系.
  - **常规的模拟会选择在NPT下进行预平衡, 再转到NVT系综进行长时间的动力学采样**
- VTμ系综是一种描述开放系统的系综，它描述的是一个恒定化学势、恒定体积、恒定温度的系统。
  - 在VTμ系综中，我们可以研究系统的粒子数和化学反应。
  - 例如，我们可以使用VTμ系综来研究气体的吸附和化学反应。通过分子动力学模拟，我们可以模拟出气体分子的吸附和化学反应，从而研究它们的性质。

### 特殊体系的系综选择

1. 两相体系: 在构建初期分别对固液两相进行平衡, 组合后先在NVT系综下限制固相位置而平衡液相, 让液相适应固相, 然后放开限制转到NPT系综进行预平衡
2. 分子尺寸相差较大的体系
   - 如溶液中的蛋白质, 可以先在NVT系综下限制蛋白质位置, 让溶液适应蛋白质位置, 然后放开限制转到NPT系综下预平衡
3. 平衡时间长的体系
   - 如离子液体, 需要在NVT系综下高温运行一段时间, 使得体系空间均匀分布, 然后降温到目标温度, 再转到NPT系综下预平衡
4. 聚合物模拟退火
   - 当需要调整聚合物体系的密度或者模拟实际物理条件下的退火过程, 则选择NPT系综

## 拓展阅读

- [分子动力学模拟常用系综 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/201411610)
- [【统计力学】平衡态理论——统计系综 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/201350705)
